import { describe, expect, it, vi } from "vitest";
import { logEvent } from "../api/log";

describe("api/log", () => {
  it("logs structured messages by level", () => {
    const info = vi.spyOn(console, "log").mockImplementation(() => {});
    const warn = vi.spyOn(console, "warn").mockImplementation(() => {});
    const error = vi.spyOn(console, "error").mockImplementation(() => {});

    logEvent("info", "x", { a: 1 });
    logEvent("warn", "y", { b: 2 });
    logEvent("error", "z", { c: 3 });

    expect(info).toHaveBeenCalledTimes(1);
    expect(warn).toHaveBeenCalledTimes(1);
    expect(error).toHaveBeenCalledTimes(1);

    info.mockRestore();
    warn.mockRestore();
    error.mockRestore();
  });
});
