import type {
  AdapterSearchOptions,
  CveSearchConfig,
  NormalizedCve,
} from "../domain/types";

export interface AdapterResult {
  cves: NormalizedCve[];
  warnings: string[];
}

export interface SourceAdapter {
  readonly source: string;
  search(query: string, options: AdapterSearchOptions): Promise<AdapterResult>;
  getById(
    cveId: string,
    signal?: AbortSignal,
  ): Promise<{ cve: NormalizedCve | null; warnings: string[] }>;
}

export interface AdapterContext {
  config: CveSearchConfig;
  fetchImpl?: typeof fetch;
}
